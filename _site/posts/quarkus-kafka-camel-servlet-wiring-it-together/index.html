<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" >
  <link rel="shortcut icon" type="image/png" href="/icon.png" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@koint">
  <meta name="twitter:creator" content="@koint">

  <!-- SEO stuff -->
  <title>Quarkus, Kafka, Camel Servlet, Wiring it Together</title>
  <meta property="og:title" content="Quarkus, Kafka, Camel Servlet, Wiring it Together" />
  <meta name="twitter:title" content="Quarkus, Kafka, Camel Servlet, Wiring it Together">


  
	  <meta name="description" content="When using Apache Camel with Quarkus as of today, we are limited number of Camel connectors. One important one being
    the Apache Kafka connector.
    The Kafka connector provided through the Smallrye Kafka Extension is available for Quarkus though. So in this
    article, I will show how to
    wire Smallrye Kafka connector and Camel together.
    We will also be using the camel-servlet component to reuse the undertow http endpoint provided by Quarkus and to
    spice things up a little we will use the XML DSL of Camel.
    All of this will be natively compiled in the end." />
	  <meta property="og:description" content="When using Apache Camel with Quarkus as of today, we are limited number of Camel connectors. One important one being
    the Apache Kafka connector.
    The Kafka connector provided through the Smallrye Kafka Extension is available for Quarkus though. So in this
    article, I will show how to
    wire Smallrye Kafka connector and Camel together.
    We will also be using the camel-servlet component to reuse the undertow http endpoint provided by Quarkus and to
    spice things up a little we will use the XML DSL of Camel.
    All of this will be natively compiled in the end." />
	  <meta name="twitter:description" content="When using Apache Camel with Quarkus as of today, we are limited number of Camel connectors. One important one being
    the Apache Kafka connector.
    The Kafka connector provided through the Smallrye Kafka Extension is available for Quarkus though. So in this
    article, I will show how to
    wire Smallrye Kafka connector and Camel together.
    We will also be using the camel-servlet component to reuse the undertow http endpoint provided by Quarkus and to
    spice things up a little we will use the XML DSL of Camel.
    All of this will be natively compiled in the end.">
  
  <link rel="canonical" href="http://0.0.0.0:4000/posts/quarkus-kafka-camel-servlet-wiring-it-together/" />
  <meta property="og:url" content="http://0.0.0.0:4000/posts/quarkus-kafka-camel-servlet-wiring-it-together/" />
  <meta name="twitter:url" content="http://0.0.0.0:4000/posts/quarkus-kafka-camel-servlet-wiring-it-together/">

  <meta property="og:site_name" content="Alain's Tech Blog" />
  <meta property="og:image" content="http://0.0.0.0:4000/assets/images//posts/quarkus-kafka-camel-servlet-wiring-it-together/top.jpg" />
  <meta name="twitter:image" content="http://0.0.0.0:4000/assets/images//posts/quarkus-kafka-camel-servlet-wiring-it-together/top.jpg">

   <!-- if it's an article -->
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2019-07-04T10:00:00+07:00" />
  <meta property="article:modified_time" content="2019-07-06T10:00:00+07:00" />

  <meta content="http://www.linkedin.com/in/alainpham" property="article:author">

  
	  
	  <meta content="development" property="article:section">
	  
  

  
	  
	  <meta content="quarkus" property="article:tag">
	  
	  <meta content="kubernetes" property="article:tag">
	  
	  <meta content="camel" property="article:tag">
	  
	  <meta content="kafka" property="article:tag">
	  
	  <meta content="smallrye" property="article:tag">
	  
  

    <script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Quarkus, Kafka, Camel Servlet, Wiring it Together",
"datePublished": "2019-07-04T10:00:00+07:00",
  
"description": "
    When using Apache Camel with Quarkus as of today, we are limited number of Camel connectors. One important one being
    the Apache Kafka connector.
    The Kafka connector provided through the Smallrye Kafka Extension is available for Quarkus though. So in this
    article, I will show how to
    wire Smallrye Kafka connector and Camel together.
    We will also be using the camel-servlet component to reuse the undertow http endpoint provided by Quarkus and to
    spice things up a little we will use the XML DSL of Camel.
    All of this will be natively compiled in the end.



",
  
"url": "http://0.0.0.0:4000/posts/quarkus-kafka-camel-servlet-wiring-it-together/"}</script>

  

  <link rel="author" href="http://www.linkedin.com/in/alainpham"/>

   <!-- End SEO stuff -->

  <link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/assets/css/font-awesome/css/font-awesome.min.css" />
  <link rel="stylesheet" href="/assets/css/main.css" />
   <link href="/assets/css/syntax.css" rel="stylesheet">

  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>

</head>

<body>
	<div>
	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button class="navbar-toggle collapsed" type="button"
					data-toggle="collapse" data-target="#navbar-collapse-menu">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"> <i class="fa fa-barcode"></i>
				</a>
			</div>
			<div id="navbar-collapse-menu" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">

					
						<!-- If has submenues -->
						
						<li class="dropdown">
							<a class="dropdown-toggle"	data-toggle="dropdown" href="#">
								Featured Projects
								<span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								
									<li>
										<a href="/projects/microbam">
											
											MicroBam
										</a>
									</li>
								
									<li>
										<a href="/projects/ourlegacy">
											
											OurLegacy
										</a>
									</li>
								
								</ul>
							</li>
						
					
						<!-- If has submenues -->
						
							<li><a href="/">Posts</a></li>
						
					
						<!-- If has submenues -->
						
							<li><a href="/tags">Tags</a></li>
						
					
						<!-- If has submenues -->
						
							<li><a href="/about">About</a></li>
						
					
						<!-- If has submenues -->
						
						<li class="dropdown">
							<a class="dropdown-toggle"	data-toggle="dropdown" href="#">
								Follow me
								<span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								
									<li>
										<a href="http://github.com/alainpham">
											
											<i class="fa fa-inverse fa-github fa-2x"></i>
											
											GitHub
										</a>
									</li>
								
									<li>
										<a href="http://www.linkedin.com/in/alainpham">
											
											<i class="fa fa-inverse fa-linkedin-square fa-2x"></i>
											
											LinkedIn
										</a>
									</li>
								
									<li>
										<a href="https://twitter.com/koint">
											
											<i class="fa fa-inverse fa-twitter fa-2x"></i>
											
											Twitter
										</a>
									</li>
								
								</ul>
							</li>
						
					
				</ul>
			</div>
		</div>
	</nav>
		
		<img
			alt="Quarkus, Kafka, Camel Servlet, Wiring it Together"
			src="/assets/images//posts/quarkus-kafka-camel-servlet-wiring-it-together/top.jpg" class="img-responsive">
		

	<div class="jumbotron  clearfix">

		<h1 class="text-center">Quarkus, Kafka, Camel Servlet, Wiring it Together</h1>

	</div>
</div>

	<div class="container">

	
	<p>
		<strong>July 04, 2019</strong> ( last updated : July 06, 2019 )
		<br>
		
			<a class="label label-default" href="/tags/#quarkus">quarkus</a>
		
			<a class="label label-default" href="/tags/#kubernetes">kubernetes</a>
		
			<a class="label label-default" href="/tags/#camel">camel</a>
		
			<a class="label label-default" href="/tags/#kafka">kafka</a>
		
			<a class="label label-default" href="/tags/#smallrye">smallrye</a>
		
    </p>
	
	<p>
    	<a href="https://github.com/alainpham/quarkus-kafka-camel-servlet" class="btn btn-default">
		    <i class="fa fa-github fa-2x"></i>  https://github.com/alainpham/quarkus-kafka-camel-servlet
			</a>
	</p>
	
	<hr>
	<h1>Abstract</h1>
	

	<p>
    When using Apache Camel with Quarkus as of today, we are limited number of Camel connectors. One important one being
    the Apache Kafka connector.
    The Kafka connector provided through the Smallrye Kafka Extension is available for Quarkus though. So in this
    article, I will show how to
    wire Smallrye Kafka connector and Camel together.
    We will also be using the camel-servlet component to reuse the undertow http endpoint provided by Quarkus and to
    spice things up a little we will use the XML DSL of Camel.
    All of this will be natively compiled in the end.
</p>
<!--more-->

<h2>Setup a project</h2>

<p>In a previous article I showed how to create a hello world using Camel and Quarkus. Here We will try to do something
    more advanced. Lets start by setting up the project</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">mkdir </span>quarkus-kafka-camel-servlet

<span class="nb">cd </span>quarkus-kafka-camel-servlet

mvn io.quarkus:quarkus-maven-plugin:0.18.0:create <span class="se">\</span>
<span class="nt">-DprojectGroupId</span><span class="o">=</span>agilabs <span class="se">\</span>
<span class="nt">-DprojectArtifactId</span><span class="o">=</span>quarkus-kafka-camel-servlet <span class="se">\</span>
<span class="nt">-DclassName</span><span class="o">=</span><span class="s2">"agilabs.GreetingResource"</span> <span class="se">\</span>
<span class="nt">-Dpath</span><span class="o">=</span><span class="s2">"/hello"</span></code></pre></figure>

<p>
    Add the following dependencies to the pom.xml file.
</p>
<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.quarkus<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>quarkus-smallrye-reactive-messaging-kafka<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.quarkus<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>quarkus-camel-core<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.quarkus<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>quarkus-camel-servlet<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<h2>Configure Camel</h2>

<h3>Application properties</h3>

<p>Configure application properties in src/main/resources/application.properties</p>

<pre>
quarkus.camel.servlet.url-patterns = /camel/*
%dev.quarkus.camel.routes-uris = camel/routes.xml
quarkus.camel.routes-uris=file:/camel/routes.xml
quarkus.camel.defer-init-phase = true
</pre>

<p>
    We will match all calls that go to /camel/* to the camel servlet component. In dev mode we will scan the file
    routes.xml for camel routes located in the classpath, in the resource folder camel.
</p>
<p>
    When launched in "production mode" with the native executable the resources are not included by default in the
    binary. I'm externalizing the routes.xml file to the folder /camel so that it can be set
    and changed dynamically. This is actually quite interesting because we get to have a configurable native executable
    that we can fine tune by switching the routes during run time.
    For some when I tried to change the property quarkus.camel.routes-uris during native run time, it's new value doesn't
    seem to be taken into account. So this file path is kind of like being hard coded right now.. 
</p>
<p><strong>Edit July 6,2019 : I discovered that there are different <a
            href="https://quarkus.io/guides/extension-authors-guide" target="_blank">Configuration Phases</a> 
            : BUILD_TIME, BUILD_AND_RUN_TIME_FIXED & RUN_TIME. 
        It turns out this property is set to BUILD_AND_RUN_TIME_FIXED, so it is not dynamically read during native run time for the moment.
        More details <a target="_blank" href="https://github.com/quarkusio/quarkus/issues/3116">here</a>.
        </strong></p>
<p>
    Quarkus.camel.defer-init-phase property is set to true because it seems that the camel context is created before all
    the CDI bean wiring and dependency injection happens.
    I need to do further digging to understand entirely how this works.
</p>

<h3>
    Camel Routes XML Files
</h3>

<p>
    Lets set up the routes in the src/main/resources/camel/routes.xml file.
</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">"http://camel.apache.org/schema/spring"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">"receive-kafka-events"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;from</span> <span class="na">uri=</span><span class="s">"direct:receive-events"</span><span class="nt">&gt;&lt;/from&gt;</span>
        <span class="nt">&lt;log</span> <span class="na">message=</span><span class="s">"Received from kafka broker : ${body}"</span><span class="nt">&gt;&lt;/log&gt;</span>
    <span class="nt">&lt;/route&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">"send-kafka-events"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;from</span> <span class="na">uri=</span><span class="s">"servlet:send"</span><span class="nt">&gt;&lt;/from&gt;</span>
        <span class="nt">&lt;log</span> <span class="na">message=</span><span class="s">"Sending"</span><span class="nt">&gt;&lt;/log&gt;</span>
        <span class="nt">&lt;convertBodyTo</span> <span class="na">type=</span><span class="s">"java.lang.String"</span><span class="nt">&gt;&lt;/convertBodyTo&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">ref=</span><span class="s">"smallrye-producer"</span> <span class="na">method=</span><span class="s">"produce(${body})"</span><span class="nt">&gt;&lt;/bean&gt;</span>
        <span class="nt">&lt;setBody&gt;</span>
            <span class="nt">&lt;constant&gt;</span>Message sent<span class="nt">&lt;/constant&gt;</span>
        <span class="nt">&lt;/setBody&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span></code></pre></figure>

<p>The first route is to consume messages coming from Kafka. We will wire later on a camel producer template to send
    messages to this route from any other class in application</p>
<p>The second route listens to http requests coming on the path <strong>http://0.0.0.0:8080/camel/send</strong>.
    It will use a bean that incorporates an emitter to send messages.
</p>

<h2>Configure sinks for Kafka topics</h2>

<h3>Application properties</h3>

<pre>
mp.messaging.incoming.in-events.connector=smallrye-kafka
mp.messaging.incoming.in-events.topic=events
mp.messaging.incoming.in-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer

mp.messaging.outgoing.out-events.connector=smallrye-kafka
mp.messaging.outgoing.out-events.topic=events
mp.messaging.outgoing.out-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer
</pre>

<p>We will configure a smallrye-kafka connector for incoming messages and outgoing messages</p>

<h3>Create a consumer</h3>

<p>Now lets go ahead and create a consumer with the @Incoming annotation. We will need to inject a Camel
    ProducerTemplate instance into the consumer so that the message can be forwarded to our Camel direct endpoint</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">agilabs</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.context.ApplicationScoped</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.camel.ProducerTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.microprofile.reactive.messaging.Incoming</span><span class="o">;</span>

<span class="nd">@ApplicationScoped</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Consumer</span> <span class="o">{</span>
    
    <span class="nd">@Inject</span>
    <span class="nc">ProducerTemplate</span> <span class="n">camelProducer</span><span class="o">;</span>

    <span class="nd">@Incoming</span><span class="o">(</span><span class="s">"in-events"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>              
        <span class="n">camelProducer</span><span class="o">.</span><span class="na">sendBody</span><span class="o">(</span><span class="s">"direct:receive-events"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3>Create a producer</h3>

<p>
    Now lets create a producer. Note that this producer will be used by the camel xml context. So it needs to support reflection to find the different methods dynamically.
    We need to register this class for reflection so that it can work once compiled to native code.
</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">agilabs</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.enterprise.context.ApplicationScoped</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.camel.ProducerTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.microprofile.reactive.messaging.Incoming</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">io.quarkus.runtime.annotations.RegisterForReflection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.smallrye.reactive.messaging.annotations.Emitter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.smallrye.reactive.messaging.annotations.Stream</span><span class="o">;</span>

<span class="nd">@ApplicationScoped</span>
<span class="nd">@RegisterForReflection</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Producer</span> <span class="o">{</span>
    
    <span class="nd">@Inject</span>
    <span class="nd">@Stream</span><span class="o">(</span><span class="s">"out-events"</span><span class="o">)</span>
    <span class="nc">Emitter</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">emitter</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">produce</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">emitter</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>       
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h2>Wiring it all together</h2>

<p>Now that we have everything configured. We need to wire everything together. Register the SmallRye producer into the
    camel context and inject a camel producer template in the Quarkus CDI context.</p>
<p>As mentioned earlier, it seems that the Camel context is started earlier than the CDI context, so when Camel
    tries to look for a bean called smallrye-producer it will fail to start because it can't find it.
    This also comes from the fact that ApplicationScoped beans are instantiated in a lazy fashion. 
    Since the smallrye-producer is never called in the CDI context, it will never be initialized.
    For these reasons we need to observe the Camel InitializedEvent and register the SmallRye producer at that specific time.
</p>
<p>
    The @Produces annotation provides the Camel producer template to the CDI context.
</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">agilabs</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.event.Observes</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.inject.Produces</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.camel.CamelContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.camel.ProducerTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.quarkus.camel.core.runtime.InitializedEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.smallrye.reactive.messaging.annotations.Emitter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.smallrye.reactive.messaging.annotations.Stream</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CamelWiring</span><span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="nc">Producer</span> <span class="n">smallRyeProducer</span><span class="o">;</span>

    <span class="nd">@Inject</span>
    <span class="nc">CamelContext</span> <span class="n">camelContext</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">registerSmallryeEmitter</span><span class="o">(</span> <span class="nd">@Observes</span> <span class="nc">InitializedEvent</span> <span class="n">ev</span> <span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">camelContext</span><span class="o">.</span><span class="na">getRegistry</span><span class="o">().</span><span class="na">bind</span><span class="o">(</span><span class="s">"smallrye-producer"</span><span class="o">,</span> <span class="n">smallRyeProducer</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Produces</span>
    <span class="kd">public</span> <span class="nc">ProducerTemplate</span> <span class="nf">buildCamelProducerTemplate</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">camelContext</span><span class="o">.</span><span class="na">createProducerTemplate</span><span class="o">();</span> <span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h2>Compiling and testing the project</h2>

<p>Now lets compile it to native code. The compilation is quite memory & CPU intensive. I guess this is due to the costly compilation of XML support libraries. 
    At peak I observed 9.8 GB of memory consumption. The whole compilation process took about 7 to 8 minutes</p>

<pre>
git clone https://github.com/alainpham/quarkus-kafka-camel-servlet.git
cd quarkus-kafka-camel-servlet
mvn package -Pnative
</pre>

<p>
    If you are in a rush. I have already built a container image for you. You can run everything wih only one command
    using the docker-compose.yml file. It will boot a zookeeper and a kafka broker using images provided by the Strimzi project and 
    also a container with the current project.
</p>

<pre>
docker-compose up
</pre>

<p>You can also get the container image directly here :
<br>
        <a href="https://hub.docker.com/r/alainpham/quarkus-kafka-camel-servlet">https://hub.docker.com/r/alainpham/quarkus-kafka-camel-servlet</a>
</p>

<p>Test it!</p>
<pre>
curl http://localhost:8080/camel/send  -X POST -H "Content-Type: text/plain"  -d 'Hello there!!'
</pre>

<p>The output should be</p>

<pre>
quarkus-kafka-camel-servlet_1  | 2019-07-05 13:12:58,025 INFO  [send-kafka-events] (executor-thread-1) Sending
quarkus-kafka-camel-servlet_1  | 2019-07-05 13:12:58,027 INFO  [io.sma.rea.mes.kaf.KafkaSink] (vert.x-eventloop-thread-1) Message org.eclipse.microprofile.reactive.messaging.Message$$Lambda$5e1799c60041209b57937765b33186671a72f6f8@7f35f7425e98 sent successfully to Kafka topic 'events'
quarkus-kafka-camel-servlet_1  | 2019-07-05 13:12:58,027 INFO  [receive-kafka-events] (vert.x-eventloop-thread-0) Received from kafka broker : Hello there!
</pre>

<p>Thanks for reading !</p>


<p><strong>Resources I used for inspiration</strong></p>
<ul>
    <li>
        <a href="https://quarkus.io/guides/kafka-guide">Quarkus Kafka Guide</a>
    </li>
    <li>
        <a href="https://quarkus.io/guides/cdi-reference">Quarkus - Contexts and Dependency Injection</a>
    </li>
    <li>
        <a href="https://github.com/gnodet/quarkus-camel">Quarkus - Camel example by Guillaume Nodet</a>
    </li>
    <li><a
            href="https://github.com/quarkusio/quarkus/blob/master/extensions/smallrye-reactive-messaging/deployment/src/test/java/io/quarkus/smallrye/reactivemessaging/StreamEmitter.java">Smallrye
            Reactive Messaging Unit Test</a></li>
</ul>


	
	<p>Originally published July 04, 2019
    <br> Latest update July 06, 2019</p>

    <p><strong>Related posts :</strong></p>
        <ul>
	    
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  <li>
			      <a href="/posts/quarkus-camel-first-impressions-on-a-game-changing-framework/">
			        Quarkus Camel, First Impressions on a Game Changing Framework
			      </a>
			  </li>
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  
			  
			  
			  
			  <li>
			      <a href="/posts/handling-large-streams-of-data-through-http-with-jboss-fuse/">
			        Handling Large Streams of Data through HTTP with JBoss Fuse
			      </a>
			  </li>
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
			  
		
		</ul>
	

	
	
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = "https://alainpham.github.io/posts/quarkus-kafka-camel-servlet-wiring-it-together/";  // Replace PAGE_URL with your page's canonical URL variable
//this.page.identifier = "/posts/quarkus-kafka-camel-servlet-wiring-it-together"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//apham.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 
	</div>
	<footer class="footer">
	<ul class="footer-links">
		<li><a href="http://github.com/alainpham"> <i
				class="fa fa-inverse fa-github fa-3x"></i></a></li>
		<li><a href="http://www.linkedin.com/in/alainpham"> <i
				class="fa fa-inverse fa-linkedin-square fa-3x"></i></a></li>
		<li><a href="https://twitter.com/koint"> <i
				class="fa fa-inverse fa-twitter fa-3x"></i></a></li>
	</ul>
</footer>
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
